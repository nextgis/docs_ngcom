.. _ngcom_data_connect:

Как подключать данные из внешних источников 
=======================================================

:ref:`Веб ГИС <ngcom_description>` поддерживает подключение подложек (:term:`TMS`-сервисов) с внешних серверов, векторных геоданных из внешних баз данных :term:`PostGIS` и подключение векторных и растровых геоданных из внешних :term:`WMS`-сервисов. 

.. _ngcom_basemap_layer:

Подложки
------------

.. warning:: 
	Создание ресурса "Подложка веб-карты" доступно только пользователям планов `Mini и Premium <http://nextgis.ru/nextgis-com/plans>`_.
 
Создайте ресурс “Подложка веб-карты”
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. Откройте :ref:`Группу ресурсов <ngcom_resources_group>`, в которой вы хотите создать подложку (на главной странице Веб ГИС по умолчанию открыта Основная группа ресурсов);
#. Выберите :menuselection:`Создать ресурс --> Подложка веб-карты` на правой панели :ref:`веб-интерфейса <ngw_admin_interface>` Веб ГИС;
#. В открывшемся окне заполните поле :guilabel:`Наименование` на вкладке :guilabel:`Ресурс`. Затем на вкладке :guilabel:`Подложка веб-карты` заполните поле :guilabel:`URL` (если вы знаете ссылку на :term:`TMS`-сервис) или начните вводить название подложки в поле :guilabel:`Поиск`. Если соответствующая подложка будет найдена в каталоге `QuickMapServices <https://qms.nextgis.com/>`_, то поле :guilabel:`URL` заполнится автоматически, также автоматически будет включена опция "Использовать настройки из QMS";
#. Нажмите кнопку :guilabel:`Создать`. Если подложка создалась успешно, то информация о ней появится в блоке :guilabel:`Дочерние ресурсы` соответствующей Группы ресурсов.

.. note:: 
	Рекомендуем сразу создать отдельную :ref:`Группу ресурсов <ngcom_resources_group>` "Подложки" или "Базовые карты" для хранения подложек, которые вы планируете подключать на свои :ref:`Веб-карты <ngcom_webmap_create>`.

Как подключить созданные подложки на Веб-карту - :ref:`здесь <ngcom_webmap_create>`.

.. _ngcom_postgis_connect:

Внешние базы PostGIS
-----------------------

.. _ngcom_postgis_connection:

Создайте ресурс “Соединение PostGIS”
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. Откройте :ref:`Группу ресурсов <ngcom_resources_group>`, в которой вы хотите создать соединение (на главной странице Веб ГИС по умолчанию открыта Основная группа ресурсов);
#. Выберите :menuselection:`Создать ресурс --> Соединение PostGIS` на правой панели :ref:`веб-интерфейса <ngw_admin_interface>` Веб ГИС;
#. В открывшемся окне заполните поле :guilabel:`Наименование` на вкладке :guilabel:`Ресурс`, затем на вкладке :guilabel:`Соединение PostGIS` заполните поля :guilabel:`Сервер`, :guilabel:`База данных`, :guilabel:`Пользователь` (если применимо) и :guilabel:`Пароль` (если применимо);
#. Нажмите кнопку :guilabel:`Создать`. Если Соединение PostGIS создалось успешно, то информация о нем появится в блоке :guilabel:`Дочерние ресурсы` соответствующей Группы ресурсов.

.. _ngcom_postgis_layer:

Создайте ресурс “Слой PostGIS”:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. Откройте :ref:`Группу ресурсов <ngcom_resources_group>`, в которой вы хотите создать слой (на главной странице Веб ГИС по умолчанию открыта Основная группа ресурсов);
#. Выберите :menuselection:`Создать ресурс --> Слой PostGIS` на правой панели :ref:`веб-интерфейса <ngw_admin_interface>` Веб ГИС;
#. В открывшемся окне заполните поле :guilabel:`Наименование` на вкладке :guilabel:`Ресурс`, затем на вкладке :guilabel:`Слой PostGIS` выберите :ref:`Соединение PostGIS <ngcom_postgis_connection>` и заполните поля :guilabel:`Схема`, :guilabel:`Таблица`, :guilabel:`Поле ID` и :guilabel:`Поле геометрии`;
#. Нажмите кнопку :guilabel:`Создать`. Если Слой PostGIS создался успешно, то информация о нем появится в блоке :guilabel:`Дочерние ресурсы` соответствующей Группы ресурсов.

Больше информации о подключении векторных геоданных из внешних баз данных PostGIS - :ref:`здесь <ngw_create_postgis_layer>`.

Если вы планируете просматривать Слой PostGIS с помощью :ref:`Веб-карты <ngcom_webmap_create>` или публиковать его через :ref:`Сервис WMS <ngcom_wms_service>`, необходимо создать для него :ref:`Стиль <ngcom_styles>`.

.. _ngcom_wms_connect:

Внешние WMS-сервисы
-------------------

.. note:: 
	В настоящее время поддерживаются версии WMS 1.1.1 и 1.3.0.

.. _ngcom_wms_connection:

Создайте ресурс “Соединение WMS”
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. Откройте :ref:`Группу ресурсов <ngcom_resources_group>`, в которой вы хотите создать cоединение (на главной странице Веб ГИС по умолчанию открыта Основная группа ресурсов);
#. Выберите :menuselection:`Создать ресурс --> Соединение WMS` на правой панели :ref:`веб-интерфейса <ngw_admin_interface>` Веб ГИС;
#. В открывшемся окне заполните поле :guilabel:`Наименование` на вкладке :guilabel:`Ресурс`, затем на вкладке :guilabel:`Соединение WMS` заполните поля :guilabel:`URL`, :guilabel:`Имя пользователя` (если применимо) и :guilabel:`Пароль` (если применимо) для подключения к серверу :term:`WMS`;
#. Нажмите кнопку :guilabel:`Создать`. Если Соединение WMS создалось успешно, то информация о нем появится в блоке :guilabel:`Дочерние ресурсы` соответствующей Группы ресурсов.

.. warning:: 
	Сервер WMS, к которому осуществляется подключение, должен поддерживать :term:`систему коодинат <система координат>` EPSG:3857.

.. _ngcom_wms_layer:

Создайте ресурс “Слой WMS”
~~~~~~~~~~~~~~~~~~~~~~~~~~

#. Откройте :ref:`Группу ресурсов <ngcom_resources_group>`, в которой вы хотите создать слой (на главной странице Веб ГИС по умолчанию открыта Основная группа ресурсов);
#. Выберите :menuselection:`Создать ресурс --> Слой WMS` на правой панели :ref:`веб-интерфейса <ngw_admin_interface>` Веб ГИС;
#. В открывшемся окне заполните поле :guilabel:`Наименование` на вкладке :guilabel:`Ресурс`, затем на вкладке :guilabel:`Слой WMS` выберите :ref:`Соединение WMS <ngcom_wms_connection>`, формат изображения и необходимые слои;
#. Нажмите кнопку :guilabel:`Создать`. Если Слой WMS создался успешно, то информация о нем появится в блоке :guilabel:`Дочерние ресурсы` соответствующей Группы ресурсов.

Больше информации о подключении геоданных из внешних сервисов WMS - :ref:`здесь <ngw_create_wms_layer>`.


.. _ngcom_tms_connect:

Внешние сервисы TMS
-------------------

.. _ngcom_tms_connection:

Создайте ресурс “Соединение TMS”
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. Откройте :ref:`Группу ресурсов <ngcom_resources_group>`, в которой вы хотите создать cоединение (на главной странице Веб ГИС по умолчанию открыта Основная группа ресурсов);
#. Выберите :menuselection:`Создать ресурс --> TMS connection` на правой панели :ref:`веб-интерфейса <ngw_admin_interface>` Веб ГИС;
#. В открывшемся окне заполните поле :guilabel:`Наименование` на вкладке :guilabel:`Ресурс`, затем на вкладке `TMS connection`выберите способ подключения к серверу `TMS`(настраиваемый или геосервисы NextGIS), а также указать шаблон URL, параметры ключа API и используемую тайловую схему.
#. Нажмите кнопку :guilabel:`Создать`. Если соединение TMS создалось успешно, то информация о нем появится в блоке :guilabel:`Дочерние ресурсы` соответствующей Группы ресурсов.

.. _ngcom_tms_layer:

Создайте ресурс “Слой TMS”
~~~~~~~~~~~~~~~~~~~~~~~~~~

#. Откройте :ref:`Группу ресурсов <ngcom_resources_group>`, в которой вы хотите создать слой (на главной странице Веб ГИС по умолчанию открыта Основная группа ресурсов);
#. Выберите :menuselection:`Создать ресурс --> Слой TMS` на правой панели :ref:`веб-интерфейса <ngw_admin_interface>` Веб ГИС;
#. В открывшемся окне заполните поле :guilabel:`Наименование` на вкладке :guilabel:`Ресурс`. На вкладке :guilabel:`Тайловый кэш` установите настройки кэширования, на вкладке `TMS слой`выберите ресурс необходимого TMS соединения и настройте параметры отображения.
#. Нажмите кнопку :guilabel:`Создать`. Если Слой TMS создался успешно, то информация о нем появится в блоке :guilabel:`Дочерние ресурсы` соответствующей Группы ресурсов.

Больше информации о подключении геоданных из внешних сервисов TMS - :ref:`здесь <ngw_create_tms_layer>`.
